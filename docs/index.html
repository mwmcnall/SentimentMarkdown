<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Wes McNall" />

<meta name="date" content="2019-04-09" />

<title>Sentiment Analysis of The Adventure Zone</title>
<!-- Material Design fonts -->
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="index_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.6/css/bootstrap.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.6/js/bootstrap.min.js"></script>
<script src="index_files/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<script src="index_files/navigation-1.1/codefolding.js"></script>
<link href="index_files/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="index_files/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="index_files/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
<link href="index_files/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
<script src="index_files/bootstrap_material-0.1/material.min.js"></script>
<script src="index_files/bootstrap_material-0.1/ripples.min.js"></script>
<link href="index_files/material-0.1/material.css" rel="stylesheet" />
<script src="index_files/material-0.1/material.js"></script>
<script src="index_files/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="index_files/d3-4.5.0/d3.min.js"></script>
<script src="index_files/sankey-1/sankey.js"></script>
<script src="index_files/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>


<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->

</head>

<body>

<div class="header-panel shadow z-2">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-3">
        <div id="header">
    <h1 class="title">Sentiment Analysis of The Adventure Zone</h1>
                <h4 class="author">Wes McNall</h4>
                <h4 class="date">2019-04-09</h4>
        </div>
    </div>
</div>
</div>
</div>


<div class="container-fluid main-container">
    <div class="row">
      <nav class="col-xs-3 menu">
        <div id="toc">
        <ul>
        <li><a href="#what-is-it">What is it?</a></li>
        <li><a href="#sourcing-the-data">Sourcing The Data</a></li>
        <li><a href="#tidy-data">Tidy Data</a></li>
        <li><a href="#pre-visualization">Pre-visualization</a></li>
        <li><a href="#visualization">Visualization</a></li>
        <li><a href="#interactive-visualizations">Interactive Visualizations</a></li>
        </ul>
        </div>
        
        
        
      </nav>
     <div class="pages col-xs-9">
     <div class="row">
       <div class="col-xs-10">



<div id="what-is-it" class="section level1">
<h1>What is it?</h1>
<div id="what-is-sentiment-analysis" class="section level3">
<h3>What is Sentiment Analysis?</h3>
<p><strong>Sentiment Analysis</strong> is the science of looking at text and trying to make conclusions from measuring those words within the text. This is accomplished by using ‘lexicons’, word dictionaries that assign words emotions, or a score based on those emotions.</p>
<p>A simple example is putting words into positive, negative, and neutral categories, and looking at how frequently each of those words appear over the course of the text.</p>
</div>
<div id="the-adventure-zone" class="section level3">
<h3>The Adventure Zone</h3>
<p>The Adventure Zone (TAZ) is a comedy podcast where the McElroy family play Dungeons and Dragons (DnD) together. It started as a fun one-off experience for them, but turned into a 69 episode emotional story that they told together.</p>
</div>
<div id="goals" class="section level3">
<h3>Goals</h3>
<p>The goal of this project is to apply the ideas of sentiment analysis to the text of the podcast and look for any interesting conclusions along the way</p>
<p>I want to look at how the emotion of the podcast changed overtime as the story became more serious, and to see how much I can measure that light-hearted factor of it. To use sentiment analysis to see what emotions were most prevalent in particular story arcs, episodes, characters, etc.</p>
</div>
<div id="navigating-this-document" class="section level3">
<h3>Navigating this document</h3>
<p>If all you want to see are the visualzations, feel free to click that tab on the left side. Otherwise please go through each section at your leisure, there is code and commentary for how I acquired the data, organized it and visualized with it.</p>
<hr />
</div>
</div>
<div id="sourcing-the-data" class="section level1">
<h1>Sourcing The Data</h1>
<p>Podcasts are an audio medium, but more and more there has been a push to have text versions posted online so that hard of hearing or deaf people can follow along with the conversation. This is sometimes released by those who make the podcast, but in the case of TAZ, a group of dedicated fans trascribed every word of the podcast.</p>
<p>This is sourced at: <a href="http://tazscripts.tumblr.com/tazscripts" class="uri">http://tazscripts.tumblr.com/tazscripts</a></p>
<p>I wrote an R script to go to this url, move through the html and extract every link to each episode</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co">### Reading in transcript ----</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">transcript_url &lt;-<span class="st"> &#39;http://tazscripts.tumblr.com/tazscripts&#39;</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">t_html =<span class="st"> </span><span class="kw">read_html</span>(transcript_url)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># Get a character vector of all the urls on the page</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">site_txt &lt;-<span class="st"> </span>t_html <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="st">  </span><span class="kw">html_nodes</span>(<span class="st">&#39;a&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="st">  </span><span class="kw">html_attr</span>(<span class="st">&#39;href&#39;</span>)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co"># Only the pertinent urls</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">site_txt &lt;-<span class="st"> </span>site_txt[<span class="dv">12</span><span class="op">:</span><span class="kw">length</span>(site_txt)]</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co"># Store as Dataframe</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">t_df &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(site_txt)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">## Labeled each individual story arc on my own</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co"># Each of the urls within t_df / b_arc are redirection urls. This means we can&#39;t run</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co"># read_html on them correctly, this mutate uses getURL from RCurl in order to get</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co"># a character vector that stores the redirected URL and then uses a combination of</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co"># str_extract and regex to get the actual URL and then store it within the tibble</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co"># using mutate</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21">redirect_url_extract_regex &lt;-<span class="st"> &#39;(?:https[-[:alnum:]:_</span><span class="ch">\\</span><span class="st">/.]+)&#39;</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22">b_arc &lt;-<span class="st"> </span>b_arc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">getURL</span>(value, <span class="dt">.opts=</span><span class="kw">curlOptions</span>(<span class="dt">followlocation=</span><span class="ot">TRUE</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> <span class="kw">str_extract</span>(value, redirect_url_extract_regex))</a>
<a class="sourceLine" id="cb1-25" data-line-number="25"></a>
<a class="sourceLine" id="cb1-26" data-line-number="26">end_ep &lt;-<span class="st"> </span><span class="dv">69</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27">list_of_urls &lt;-<span class="st"> </span>b_arc<span class="op">$</span>value[<span class="dv">1</span><span class="op">:</span>end_ep]</a>
<a class="sourceLine" id="cb1-28" data-line-number="28"></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co"># Creating an empty dataframe to be filled</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co"># Everything is a character defaultly, and I will manually change everything after the</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="co"># master is built, to save processing and time</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32">master_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb1-33" data-line-number="33">  <span class="dt">raw =</span> <span class="kw">character</span>(), </a>
<a class="sourceLine" id="cb1-34" data-line-number="34">  <span class="dt">section =</span> <span class="kw">character</span>(), </a>
<a class="sourceLine" id="cb1-35" data-line-number="35">  <span class="dt">arc =</span> <span class="kw">character</span>(),</a>
<a class="sourceLine" id="cb1-36" data-line-number="36">  <span class="dt">ep_num =</span> <span class="kw">character</span>(),</a>
<a class="sourceLine" id="cb1-37" data-line-number="37">  <span class="dt">part_num =</span> <span class="kw">character</span>(),</a>
<a class="sourceLine" id="cb1-38" data-line-number="38">  <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p>After getting all the links organized and figuring out the structure of the html for these pages, I wrote a function to get the raw data from the html and then put it all into one dataframe</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Converts HTML as plain text to a single column dataframe</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># Stored as a character vector</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">HTMLToTibble &lt;-<span class="st"> </span><span class="cf">function</span>(html) {</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="co"># Convert html to lines of text</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  site_txt &lt;-<span class="st"> </span>html <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="st">    </span><span class="kw">html_nodes</span>(<span class="st">&#39;p&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="st">    </span><span class="kw">html_text</span>()</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="co"># Convert text to df (tibble)</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  df &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(site_txt)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  <span class="co"># Convert from factors to character</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  df[] &lt;-<span class="st"> </span><span class="kw">lapply</span>(df, as.character)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">  <span class="co"># Drop empty text rows / rows with spaces</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">  df &lt;-<span class="st"> </span>df[<span class="kw">nchar</span>(df<span class="op">$</span>value) <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>,]</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  <span class="co">#Change &#39;value&#39; to &#39;raw&#39;, as in &#39;raw text data&#39;</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  <span class="kw">colnames</span>(df) &lt;-<span class="st"> &#39;raw&#39;</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16">  <span class="kw">return</span>(df)</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co"># Loops through the url list and builds the master dataframe of information</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>end_ep) {</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">  <span class="co"># Wait 5 seconds before getting the next url request</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23">  <span class="kw">Sys.sleep</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">  <span class="co"># Gets the tibble information from the url</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25">  tib &lt;-<span class="st"> </span><span class="kw">HTMLToTibble</span>(<span class="kw">read_html</span>(list_of_urls[i]))</a>
<a class="sourceLine" id="cb2-26" data-line-number="26">  <span class="co"># Label the raw information w/ episode information</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27">  tib &lt;-<span class="st"> </span><span class="kw">LabelEpisode</span>(tib, b_arc<span class="op">$</span>section[i], b_arc<span class="op">$</span>arc[i],</a>
<a class="sourceLine" id="cb2-28" data-line-number="28">                      b_arc<span class="op">$</span>ep_num[i], b_arc<span class="op">$</span>part_num[i])</a>
<a class="sourceLine" id="cb2-29" data-line-number="29">  <span class="co"># Add tabelled tibble to master dataframe</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30">  master_df &lt;-<span class="st"> </span>master_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="st">    </span><span class="kw">full_join</span>(tib)</a>
<a class="sourceLine" id="cb2-32" data-line-number="32">}</a></code></pre></div>
<pre><code>## Observations: 57,320
## Variables: 5
## $ raw      &lt;chr&gt; &quot;The Adventure ZoneDungeon Master &amp; NPCs: Griffin McE...
## $ section  &lt;chr&gt; &quot;Balance Arc&quot;, &quot;Balance Arc&quot;, &quot;Balance Arc&quot;, &quot;Balance...
## $ arc      &lt;chr&gt; &quot;Here There Be Gerblins&quot;, &quot;Here There Be Gerblins&quot;, &quot;...
## $ ep_num   &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;...
## $ part_num &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;...</code></pre>
<hr />
<div id="speakers-and-lines" class="section level3">
<h3>Speakers and Lines</h3>
<hr />
<p>We have all the data!</p>
<p>But, it’s not organized in the best of ways. Every line spoken is mixed with the character / person who spoke it. Ideally I’d like to have the speaker for each line in a column, and the line they speak in a separate column.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Splits a single column dataframe into &#39;speaker&#39; and &#39;line&#39; based on &#39;:&#39;</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># Any line without a colon is stored completely in &#39;line&#39;, speaker is NA</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># Deals with whitespace and extraneous blank lines</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">SplitOnColon &lt;-<span class="st"> </span><span class="cf">function</span>(df) {</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  <span class="co"># Drop any rows that contain no letters or numbers</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">  df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&#39;![[:alnum:]]&#39;</span>, raw))</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  temp &lt;-<span class="st"> </span>df</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">  <span class="co"># Instantiate temporary storing column</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">  temp[<span class="st">&#39;temp&#39;</span>] &lt;-<span class="st"> &#39;&#39;</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  </a>
<a class="sourceLine" id="cb4-13" data-line-number="13">  <span class="co"># Takes all values without a : in the column, put it in a new column</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">  temp[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&#39;:&#39;</span>, temp<span class="op">$</span>raw),] &lt;-<span class="st"> </span>temp[<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&#39;:&#39;</span>, temp<span class="op">$</span>raw),] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">temp =</span> raw,</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">           <span class="dt">raw =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb4-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb4-18" data-line-number="18">  <span class="co"># Locations of colon</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19">  <span class="co"># 1 is start, 2 is end</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20">  colon_locations &lt;-<span class="st"> </span><span class="kw">str_locate</span>(temp<span class="op">$</span>raw, <span class="st">&#39;:&#39;</span>)</a>
<a class="sourceLine" id="cb4-21" data-line-number="21">  <span class="co"># Gets all the substrings from the raw from before the colon</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22">  before_colon &lt;-<span class="st"> </span><span class="kw">str_sub</span>(temp<span class="op">$</span>raw, <span class="dt">start =</span> <span class="dv">1</span>, <span class="dt">end =</span> colon_locations[,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-23" data-line-number="23">  </a>
<a class="sourceLine" id="cb4-24" data-line-number="24">  word_count &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">strsplit</span>(before_colon, <span class="st">&quot; &quot;</span>), length)</a>
<a class="sourceLine" id="cb4-25" data-line-number="25">  letter_count &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(before_colon, nchar))</a>
<a class="sourceLine" id="cb4-26" data-line-number="26">  </a>
<a class="sourceLine" id="cb4-27" data-line-number="27">  temp<span class="op">$</span>raw &lt;-<span class="st"> </span><span class="kw">str_trim</span>(temp<span class="op">$</span>raw, <span class="dt">side =</span> <span class="st">&#39;both&#39;</span>)</a>
<a class="sourceLine" id="cb4-28" data-line-number="28">  </a>
<a class="sourceLine" id="cb4-29" data-line-number="29">  <span class="co"># All the possible ways a line will NOT have a valid speaker</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30">  fail_conditions &lt;-</a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="st">    </span>(word_count <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>letter_count <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>) <span class="op">|</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="st">    </span>(word_count <span class="op">==</span><span class="st"> </span><span class="dv">3</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="st">       </span><span class="co"># 3 words and no &#39;&amp;&#39; or &#39;and&#39;</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="st">       </span>( <span class="op">!</span><span class="kw">grepl</span>(<span class="st">&#39;(&amp;)|(and)&#39;</span>, before_colon))) <span class="op">|</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="st">    </span>(letter_count <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>) <span class="op">|</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="st">    </span>(<span class="kw">grepl</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">[&#39;</span>, before_colon)) <span class="op">|</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="st">    </span>(<span class="kw">grepl</span>(<span class="st">&#39;Episode&#39;</span>, before_colon)) <span class="op">|</span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="st">    </span>(<span class="kw">grepl</span>(<span class="st">&#39;http&#39;</span>, before_colon)) <span class="op">|</span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="st">    </span>(<span class="kw">grepl</span>(<span class="st">&#39;Sponsor&#39;</span>, before_colon))</a>
<a class="sourceLine" id="cb4-40" data-line-number="40">  </a>
<a class="sourceLine" id="cb4-41" data-line-number="41">  <span class="co"># Any line that fails give no speaker</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42">  temp[ (fail_conditions <span class="op">%in%</span><span class="st"> </span>T),] &lt;-<span class="st"> </span>temp[ (fail_conditions <span class="op">%in%</span><span class="st"> </span>T),] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">temp =</span> raw,</a>
<a class="sourceLine" id="cb4-44" data-line-number="44">           <span class="dt">raw =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb4-45" data-line-number="45"></a>
<a class="sourceLine" id="cb4-46" data-line-number="46">  <span class="co"># Separates into columns of &#39;speaker&#39; and &#39;line, based on :</span></a>
<a class="sourceLine" id="cb4-47" data-line-number="47">  temp &lt;-<span class="st"> </span><span class="kw">separate</span>(temp, <span class="dt">col =</span> <span class="st">&#39;raw&#39;</span>,<span class="dt">sep =</span> <span class="st">&#39;:&#39;</span>, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&#39;speaker&#39;</span>, <span class="st">&#39;line&#39;</span>), <span class="dt">fill =</span> <span class="st">&#39;left&#39;</span>,</a>
<a class="sourceLine" id="cb4-48" data-line-number="48">                 <span class="dt">extra =</span> <span class="st">&#39;merge&#39;</span>)</a>
<a class="sourceLine" id="cb4-49" data-line-number="49">  </a>
<a class="sourceLine" id="cb4-50" data-line-number="50">  <span class="co"># Combine columns</span></a>
<a class="sourceLine" id="cb4-51" data-line-number="51">  temp<span class="op">$</span>line &lt;-<span class="st"> </span><span class="kw">paste</span>(temp<span class="op">$</span>line, temp<span class="op">$</span>temp)</a>
<a class="sourceLine" id="cb4-52" data-line-number="52">  <span class="co"># Drop templine</span></a>
<a class="sourceLine" id="cb4-53" data-line-number="53">  temp &lt;-<span class="st"> </span>temp[, <span class="kw">c</span>(<span class="st">&#39;speaker&#39;</span>, <span class="st">&#39;line&#39;</span>)]</a>
<a class="sourceLine" id="cb4-54" data-line-number="54">  </a>
<a class="sourceLine" id="cb4-55" data-line-number="55">  <span class="co"># Trim Whitespace from both sides for both columns</span></a>
<a class="sourceLine" id="cb4-56" data-line-number="56">  temp<span class="op">$</span>speaker &lt;-<span class="st"> </span><span class="kw">str_trim</span>(temp<span class="op">$</span>speaker, <span class="dt">side =</span> <span class="st">&#39;both&#39;</span>)</a>
<a class="sourceLine" id="cb4-57" data-line-number="57">  temp<span class="op">$</span>line &lt;-<span class="st"> </span><span class="kw">str_trim</span>(temp<span class="op">$</span>line, <span class="dt">side =</span> <span class="st">&#39;both&#39;</span>)</a>
<a class="sourceLine" id="cb4-58" data-line-number="58"></a>
<a class="sourceLine" id="cb4-59" data-line-number="59">  <span class="co"># Replace speaker NA&#39;s with &#39;&#39;</span></a>
<a class="sourceLine" id="cb4-60" data-line-number="60">  temp<span class="op">$</span>speaker[<span class="kw">is.na</span>(temp<span class="op">$</span>speaker)] &lt;-<span class="st"> &#39;&#39;</span></a>
<a class="sourceLine" id="cb4-61" data-line-number="61">  </a>
<a class="sourceLine" id="cb4-62" data-line-number="62">  <span class="co"># Combine</span></a>
<a class="sourceLine" id="cb4-63" data-line-number="63">  df &lt;-<span class="st"> </span><span class="kw">bind_cols</span>(df, temp)</a>
<a class="sourceLine" id="cb4-64" data-line-number="64">  <span class="co"># Drop raw line</span></a>
<a class="sourceLine" id="cb4-65" data-line-number="65">  df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-66" data-line-number="66"><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>raw)</a>
<a class="sourceLine" id="cb4-67" data-line-number="67">  </a>
<a class="sourceLine" id="cb4-68" data-line-number="68">  <span class="co"># Drop completely blank lines</span></a>
<a class="sourceLine" id="cb4-69" data-line-number="69">  df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-70" data-line-number="70"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">nchar</span>(line) <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-71" data-line-number="71">  <span class="co"># Drop lines with a {</span></a>
<a class="sourceLine" id="cb4-72" data-line-number="72">  df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-73" data-line-number="73"><span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">grepl</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">{&#39;</span>, speaker))</a>
<a class="sourceLine" id="cb4-74" data-line-number="74">  </a>
<a class="sourceLine" id="cb4-75" data-line-number="75">  <span class="kw">return</span>(df)</a>
<a class="sourceLine" id="cb4-76" data-line-number="76">}</a></code></pre></div>
<p>The above function handles the vast majority of all possible options of the data, amazing!</p>
<p>But, because these transcripts were created by a community of fans following a general style guide, there were a few inconsistencies an algorithm can’t find easily. I went through the data myself and looked for these errors and fixed them by hand</p>
<pre><code>## # A tibble: 6 x 6
##   section   arc         ep_num part_num speaker line                      
##   &lt;chr&gt;     &lt;chr&gt;        &lt;int&gt;    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;                     
## 1 Balance ~ Here There~      1        1 &quot;&quot;      The Adventure ZoneDungeon~
## 2 Balance ~ Here There~      1        1 &quot;&quot;      Episode 1: Here There Be ~
## 3 Balance ~ Here There~      1        1 Griffin Hey everybody, this is Gr~
## 4 Balance ~ Here There~      1        1 Griffin So that is the plan, we a~
## 5 Balance ~ Here There~      1        1 Announ~ Strap on your fantasy sea~
## 6 Balance ~ Here There~      1        1 &quot;&quot;      [Theme music: “Déjà Vu” b~</code></pre>
<p>Much better! Now that we have a much more organized dataset, we can begin the first steps of sentiment analysis</p>
<hr />
</div>
</div>
<div id="tidy-data" class="section level1">
<h1>Tidy Data</h1>
<p>When working with sentiment analysis, we are analyzing the words and the order the words are spoken in. This means we have to separate each of the words spoken from each of the lines but still keep everything labeled and organized.</p>
<p>Thankfully <strong>tidytext</strong> exists to make this easy for us with the <code>unnest_tokens()</code> function</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Assign line numbers</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">line_number =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(df),</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">         <span class="co"># Number of words in the line</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">         <span class="dt">line_wc =</span> <span class="kw">sapply</span>(<span class="kw">strsplit</span>(line, <span class="st">&quot; &quot;</span>), length))</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co"># unnest_tokens here separates all the words from their lines and keeps their</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co"># individual line number, speaker, part number, ep number, arc, and section intact</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">tidy_df &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="st">  </span><span class="kw">group_by</span>(section, arc, ep_num, part_num, speaker) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="st">  </span><span class="kw">unnest_tokens</span>(word, line) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="st">  </span><span class="kw">ungroup</span>()</a></code></pre></div>
<p>Now we have an organized dataframe with each of the words separated from the lines but still correctly labeled. This is the form our data has to be in for sentiment analysis.</p>
<pre><code>## # A tibble: 6 x 8
##   section   arc         ep_num part_num speaker line_number line_wc word  
##   &lt;chr&gt;     &lt;chr&gt;        &lt;int&gt;    &lt;int&gt; &lt;chr&gt;         &lt;int&gt;   &lt;int&gt; &lt;chr&gt; 
## 1 Balance ~ Here There~      1        1 Griffin           3     116 hey   
## 2 Balance ~ Here There~      1        1 Griffin           3     116 every~
## 3 Balance ~ Here There~      1        1 Griffin           3     116 this  
## 4 Balance ~ Here There~      1        1 Griffin           3     116 is    
## 5 Balance ~ Here There~      1        1 Griffin           3     116 griff~
## 6 Balance ~ Here There~      1        1 Griffin           3     116 mcelr~</code></pre>
</div>
<div id="pre-visualization" class="section level1">
<h1>Pre-visualization</h1>
<p>Almost to graphs!</p>
<p>When it comes to sentiment analysis, it can be useuful to have a list of words that you <strong>don’t</strong> want to analyze. These can be filler words by someone that you don’t want assigned an emotion or words that shouldn’t be analyzed for a different reason.</p>
<p>Because this analysis is over a DnD podcast, there are DnD-specific words that come up that shouldn’t be analyzed</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">ban_words &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;like&#39;</span>, <span class="st">&#39;damage&#39;</span>, <span class="st">&#39;magic&#39;</span>, <span class="st">&#39;attack&#39;</span>, <span class="st">&#39;magical&#39;</span>, <span class="st">&#39;disadvantage&#39;</span>, </a>
<a class="sourceLine" id="cb8-2" data-line-number="2">               <span class="st">&#39;advantage&#39;</span>, <span class="st">&#39;dungeon&#39;</span>, <span class="st">&#39;dungeons&#39;</span>, <span class="st">&#39;arcane&#39;</span>, <span class="st">&#39;arcana&#39;</span>, <span class="st">&#39;pan&#39;</span>)</a></code></pre></div>
<p>So for our analysis we have to join our tidy data with different <em>sentiment lexicons</em> in order to visualize them. There are three common ones, listed below. Click on one to see more information about it</p>
<div id="section" class="section level2 tabset tabset-fade">
<h2></h2>
<div id="bing" class="section level3">
<h3>Bing</h3>
<p>The <strong>Bing sentiment lexicon</strong> is the simplest one. It puts words into three simple categories:</p>
<ul>
<li>Positive</li>
<li>Negative</li>
<li>Neutral</li>
</ul>
<p>And that’s it!</p>
<p>Because we have separated our data into individual words, getting the data for visualization is very simple</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">bing_sen &lt;-<span class="st"> </span>tidy_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(<span class="kw">get_sentiments</span>(<span class="st">&#39;bing&#39;</span>), <span class="st">&#39;word&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>word <span class="op">%in%</span><span class="st"> </span>ban_words)</a></code></pre></div>
</div>
<div id="afinn" class="section level3">
<h3>Afinn</h3>
<p>The <strong>Afinn Sentiment Lexicon</strong> is similar to Bing. It puts words into two categories:</p>
<ul>
<li>Positive</li>
<li>Negative</li>
</ul>
<p>But it does this on a scale from -5 to 5, rating the word based on it’s emotional severity from very negative to very positive</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">afinn_sen &lt;-<span class="st"> </span>tidy_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(<span class="kw">get_sentiments</span>(<span class="st">&#39;afinn&#39;</span>), <span class="st">&#39;word&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>word <span class="op">%in%</span><span class="st"> </span>ban_words)</a></code></pre></div>
</div>
<div id="nrc" class="section level3">
<h3>NRC</h3>
<p>The <strong>NRC Sentiment Lexicon</strong> is the most nuanced of the three. It puts words into these emotional categories:</p>
<ul>
<li>Anger</li>
<li>Anticipation</li>
<li>Digust</li>
<li>Fear</li>
<li>Joy</li>
<li>Negative</li>
<li>Positive</li>
<li>Sadness</li>
<li>Surprise</li>
<li>Trust</li>
</ul>
<p>A word <strong>can</strong> be assigned more than one emotion.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">nrc_sen &lt;-<span class="st"> </span>tidy_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(<span class="kw">get_sentiments</span>(<span class="st">&#39;nrc&#39;</span>), <span class="st">&#39;word&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>word <span class="op">%in%</span><span class="st"> </span>ban_words)</a></code></pre></div>
</div>
</div>
<div id="section-1" class="section level2">
<h2></h2>
</div>
</div>
<div id="visualization" class="section level1">
<h1>Visualization</h1>
<p>We made it! All the necessary work is done and now we can have some fun!</p>
<p>Each different <em>sentiment lexicon</em> can be used for different visualizations, so click on whatever tab you’re interested in seeing</p>
<div id="section-2" class="section level2 tabset tabset-fade">
<h2></h2>
<div id="bing-1" class="section level3">
<h3>Bing</h3>
<p>There’s a lot we can do when it comes to positive / negative words. The simplest being just looking at the most popular positive, negative and neutral words from a given speaker</p>
<p>These are the top 10 most popular words per category</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/unnamed-chunk-14-1.png" alt="Top words Overall" width="768" />
<p class="caption">
Top words Overall
</p>
</div>
<p>Even just looking at this basic breakdown of positive / negative words in the podcast, we already get the sense that positivity is much more popularity than negativity. The most popular negative sentiment word has a smaller count than the top <strong>6</strong> positive words.</p>
<p>Let’s continue looking to see if this trend continues.</p>
<hr />
<p>We can also look at how the general tone of a character is maintained over the course of the podcast, by looking at how often they use positive and negative words</p>
<p>Here are the 4 hosts of the podcast</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/unnamed-chunk-15-1.png" alt="Character Arc Emotions" width="768" />
<p class="caption">
Character Arc Emotions
</p>
</div>
<p>That positive trend continues with our hosts! But because DnD is a roleplaying game, there are characters that people play, here are the main character’s sentiment breakdown</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/unnamed-chunk-16-1.png" alt="Character Arc Emotions" width="768" />
<p class="caption">
Character Arc Emotions
</p>
</div>
<p>The trend continues even with the characters they play!</p>
<hr />
</div>
<div id="afinn-1" class="section level3">
<h3>Afinn</h3>
<p>We can work with <code>joy plots</code>, also called <code>ridgeline plots</code>. These are density curves of a particular sentiment overtime. These density curves are split by story arc.</p>
<p>Because Bing and Afinn are similar sentiment lexicons, it’s possible to make graphs using the two of them together. These ridgeline plots utilize both Bing and Afinn, to both categorize the emotion and the strength of the emotion.</p>
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>When the two density curves have the same highs and the same lows, it implies more a neutral tone happening during that arc, or at the very least, an equal amount of positive and negative sentiment within a small time frame.</p>
<hr />
<p>For the most part I’ve looked at individual speakers or just included everyone within the podcast, but for this next graph, I wanted to look at the 5 most popular NPCs per story arc and to look at their positive / negative impact on the story.</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/unnamed-chunk-18-1.png" alt="Top 5 NPCs per arc" width="768" />
<p class="caption">
Top 5 NPCs per arc
</p>
</div>
<p>The positive trend continues for the most part even with the NPCs!</p>
<hr />
<p>What about if we just looked at each individual episode of the podcast? How would the score from each episode compare to one another?</p>
<p>Each vertical line / color of the bar designates the different story arcs of the podcast.</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/unnamed-chunk-19-1.png" alt="Episode Scores" width="960" />
<p class="caption">
Episode Scores
</p>
</div>
<p>Looking episode by episode, there is only <strong>one</strong> that is negative overall, and not even by that much compared to everything else.</p>
<hr />
<p>Let’s look more on an individual arc basis and try and track the total positive / negative sentiment. We can do this on a lot of different scales, but I chose to get a total sentiment by every 10 lines of Dialogue.</p>
<p>That is, looking at 10 lines of Dialogue, getting the total positive / negative score and then that becomes a bar in the chart. Longer arcs have thinner bars and shorter arcs have thicker bars.</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/unnamed-chunk-20-1.png" alt="Closer look at arc scores" width="960" />
<p class="caption">
Closer look at arc scores
</p>
</div>
<p>The closer look at the total positive / negative sentiment score helps show that there are negative times in the story, but overall the positive times win nearly everytime.</p>
<p>I think it goes to show just how much fun it can be to listen to, and on how high of a note it ended on!</p>
<hr />
</div>
<div id="nrc-1" class="section level3">
<h3>NRC</h3>
<p>It can be fun to do <code>ridgeline plots</code> with NRC, as there are a lot more emotions to look at instead of just positive and negative</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/unnamed-chunk-21-1.png" alt="NRC Ridgelines" width="768" />
<p class="caption">
NRC Ridgelines
</p>
</div>
<p>Looking at how emotions changed over the course of the podcast, using all characters, it can be hard to tell the high points and the low points. There are definitely spikes of different emotions, but let’s get more specific</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/unnamed-chunk-22-1.png" alt="NRC Ridgelines" width="768" />
<p class="caption">
NRC Ridgelines
</p>
</div>
<p>By just focusing on a single arc, the emotional path of the characters seems a lot more clear.</p>
<p>What if we focus on the emotional path of just a single character in an arc?</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/unnamed-chunk-23-1.png" alt="NRC Ridgelines" width="768" />
<p class="caption">
NRC Ridgelines
</p>
</div>
<p>By focusing on just a single character in a single arc, we get a sense of their emotions over the course of that contained story.</p>
</div>
<div id="sankey" class="section level3">
<h3>Sankey</h3>
<p>Sankey diagrams are a specific type of flow diagram, with the width of the arrows being proportional to the flow quantity.</p>
<p>We can use these types of graphs with words, specifically with phrases, to be able to see how popular some word flows are.</p>
<p>An example of that is a catch-phrase of one of the characters Magnus, is ‘Magnus rushes in’. I was curious how popular this phrase was for him, so I found all the patterns of sentences that fit the structure:</p>
<div class="line-block">       Magnus _____ _____</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Regex pattern for &#39;Magnus word word&#39;</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">pattern &lt;-<span class="st"> &#39;(Magnus)</span><span class="ch">\\</span><span class="st">s(</span><span class="ch">\\</span><span class="st">w+)</span><span class="ch">\\</span><span class="st">s(</span><span class="ch">\\</span><span class="st">w+)&#39;</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co"># Get only those exact matches from lines</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">s_df &lt;-<span class="st"> </span><span class="kw">str_extract</span>(df<span class="op">$</span>line, pattern)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co"># Get rid of all NAs ans store as dataframe</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">s_df &lt;-<span class="st"> </span>s_df[<span class="op">!</span><span class="kw">is.na</span>(s_df)]</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">s_df &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(<span class="kw">as.data.frame</span>(s_df))</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co"># Separate each of those words into columns</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">s_df &lt;-<span class="st"> </span><span class="kw">separate</span>(s_df, <span class="dt">col =</span> <span class="st">&#39;s_df&#39;</span>, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&#39;word1&#39;</span>, <span class="st">&#39;word2&#39;</span>, <span class="st">&#39;word3&#39;</span>), <span class="dt">sep =</span> <span class="st">&#39; &#39;</span>)</a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co"># Delete a few problem rows</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11">s_df &lt;-<span class="st"> </span>s_df[<span class="op">-</span><span class="kw">c</span>(<span class="dv">307</span>, <span class="dv">208</span>, <span class="dv">59</span>, <span class="dv">26</span>),]</a></code></pre></div>
<p>I did some editing of this dataframe on my own as it was a bit too large to be readable otherwise</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Load edited dataset</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">s_df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;s_df.csv&#39;</span>, <span class="dt">stringsAsFactors =</span> F)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co"># Sankey Diagrams require data to be stored in this structure:</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co"># Source | Target | Value</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co"># This means restructuring our data a little bit</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">stv &lt;-<span class="st"> </span>s_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(word1, word2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="st">  </span>tally</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw">names</span>(stv) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;source&#39;</span>, <span class="st">&#39;target&#39;</span>, <span class="st">&#39;value&#39;</span>)</a>
<a class="sourceLine" id="cb13-11" data-line-number="11">stv2 &lt;-<span class="st"> </span>s_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="st">  </span><span class="kw">group_by</span>(word2, word3) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="st">  </span>tally</a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="kw">names</span>(stv2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;source&#39;</span>, <span class="st">&#39;target&#39;</span>, <span class="st">&#39;value&#39;</span>)</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">stv &lt;-<span class="st"> </span>stv <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="st">  </span><span class="kw">full_join</span>(stv2)</a>
<a class="sourceLine" id="cb13-17" data-line-number="17"></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co"># Sankey Daigrams require two dataframes, a node and a link. Basically a list of key</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co"># words taht will identify the blocks, that&#39;s the node (u_sankey) and a list of connections,</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co"># (links) that have a unique number identifier and a count value associated with them </span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21">u_sankey &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">c</span>(<span class="kw">unique</span>(s_df<span class="op">$</span>word1), <span class="kw">unique</span>(s_df<span class="op">$</span>word2), <span class="kw">unique</span>(s_df<span class="op">$</span>word3)))</a>
<a class="sourceLine" id="cb13-22" data-line-number="22">u_sankey &lt;-<span class="st"> </span><span class="kw">as.tibble</span>(<span class="kw">as.data.frame</span>(u_sankey))</a>
<a class="sourceLine" id="cb13-23" data-line-number="23"><span class="kw">names</span>(u_sankey) &lt;-<span class="st"> &#39;name&#39;</span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"></a>
<a class="sourceLine" id="cb13-25" data-line-number="25">links &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">source =</span> <span class="kw">match</span>(stv<span class="op">$</span>source, u_sankey<span class="op">$</span>name) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb13-26" data-line-number="26">                    <span class="dt">target =</span> <span class="kw">match</span>(stv<span class="op">$</span>target, u_sankey<span class="op">$</span>name) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb13-27" data-line-number="27">                    <span class="dt">value =</span> stv<span class="op">$</span>value)</a>
<a class="sourceLine" id="cb13-28" data-line-number="28"></a>
<a class="sourceLine" id="cb13-29" data-line-number="29"><span class="co"># Use the networkD3 library to plot this sankey diagram</span></a>
<a class="sourceLine" id="cb13-30" data-line-number="30"></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="kw">library</span>(networkD3)</a>
<a class="sourceLine" id="cb13-32" data-line-number="32"><span class="kw">sankeyNetwork</span>(<span class="dt">Links =</span> links, <span class="dt">Nodes =</span> u_sankey, <span class="dt">Source =</span> <span class="st">&quot;source&quot;</span>, </a>
<a class="sourceLine" id="cb13-33" data-line-number="33">              <span class="dt">Target =</span> <span class="st">&quot;target&quot;</span>, <span class="dt">Value =</span> <span class="st">&quot;value&quot;</span>,</a>
<a class="sourceLine" id="cb13-34" data-line-number="34">              <span class="dt">fontSize =</span> <span class="dv">12</span>, <span class="dt">nodeWidth =</span> <span class="dv">20</span>)</a></code></pre></div>
<div class="figure" style="text-align: center">
<div id="htmlwidget-e5235b284ac6023e8918" style="width:768px;height:576px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5235b284ac6023e8918">{"x":{"links":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,4,4,4,4,5,6,7,7,7,7,7,7,7,7,8,9,10,11,12,13,14,15,16,17,18,18],"target":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,6,22,24,21,25,23,26,20,30,29,28,25,6,27,19,10,31,22,20,25,6,32,33,23,23,34,36,35],"value":[2,2,3,11,2,2,23,1,4,2,2,9,3,2,2,2,2,4,2,2,3,3,3,2,2,1,2,2,2,2,4,1,1,5,5,3,1,4,2,2,9,3,2,2,2,2,2,2]},"nodes":{"name":["Magnus","does","drinks","gets","has","immediately","in","is","kind","make","on","raises","rushes","starts","steps","turns","wants","with","would","not","the","had","a","to","been","his","assumes","just","gonna","fine","actually","of","changing","into","your","never","have"]},"options":{"NodeID":1,"NodeGroup":1,"LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":20,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Magnus _____ _____
</p>
</div>
<p>The <code>networkD3</code> library allows us to create a Sankey Diagram where we can hover over any connection in the dataset and see how popular that connection is. Out of all the three word phrases that the character Magnus has, ‘Magnus rushes in’ is one of the strongest, as we can tell by the size of each of the rectangular nodes</p>
<hr />
<p>Another few phrases stuck out to me that I wanted to look at. The name of the podcast itself, ‘The Adventure Zone’, and a particular spell that was cast many a time, ‘Zone of Truth’. I thought it’d be fun to take a look at all these together</p>
<div class="figure" style="text-align: center">
<div id="htmlwidget-4e5b9d7b27c1a1a1cd7b" style="width:768px;height:384px;" class="sankeyNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4e5b9d7b27c1a1a1cd7b">{"x":{"links":{"source":[0,1,1,2,3,3,3,3,3],"target":[3,4,5,0,6,7,8,9,1],"value":[232,44,1,242,1,1,5,1,7]},"nodes":{"name":["Adventure","of","The","Zone","Truth","Truthfulnessosity","Dungeon","experience","is","narrative"]},"options":{"NodeID":1,"NodeGroup":1,"LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":20,"nodePadding":50,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
The Adventure Zone of Truth
</p>
</div>
<p>And there we have it! A fun sankey diagram looking at a few different phrases from the podcast.</p>
</div>
</div>
<div id="section-3" class="section level2">
<h2></h2>
</div>
</div>
<div id="interactive-visualizations" class="section level1">
<h1>Interactive Visualizations</h1>
<p>While working on this project, I created a few interactive visualiations that were showcased in thise notebook via <code>Tableau</code>.</p>
<p><a href="https://public.tableau.com/profile/wesley.mcnall#!/vizhome/InteractiveJoy/SentimentScore">Here is the link if you want to play with some of the visualizations</a></p>
</div>

    </div>
    <div class="col-xs-2">
        </div>
  </div>
  </div>
  </div>
  <div class="row">
    </div>
  </div>

<script>
$(document).ready(function () {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');

    var images = $('.pages img');
  images.filter(function() {
      if ($(this).parent().attr("class") == "figure") {
          return(false)
      } else {
          return(true);
      }
  }).wrap("<div class='figure'></div>");
  images.addClass("image-thumb").wrap("<div class='panel-body'></div>");
  $('.figure p.caption').wrap("<div class='panel-footer'></div>");
  $('.figure').addClass('panel panel-default');
  
    $('.pages img')
 	  .addClass("image-lb");
  $('.pages').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
        delegate: 'img',
	      gallery: {enabled: false },
          removalDelay: 500,
          callbacks: {
              beforeOpen: function() {
                // just a hack that adds mfp-anim class to markup
                this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
              }
          },
          mainClass: 'mfp-move-from-top',
	      image: {
	        verticalFit: true,
            titleSrc: 'alt'
	      }
 	    });
 	
    
    $('#toc ul li').first().addClass("active");
    $('#toc ul li').attr("data-target", function() {
        return($(this).children("a").attr("href"));
    })
    $('body .section.level1').first().addClass("active");
    
    $('#toc a[href*="#"]').click(function() {

      var id = $(this).attr("href");
      if (id === "#") return;
      if (id.substring(0, 8) === "#dyntab-") return;
      toggle_page(id);

      // Menu
      var menu_entry = $(".menu li[data-target='"+id+"']");
      menu_entry.addClass("active");
      $(".menu li").not(menu_entry).removeClass("active"); 
      

    });

    function toggle_page(id) {
      $(".page").not(page).removeClass("active").hide();
      window.page = id;
      var page = $(window.page);
      window.location.hash = window.page;
      //$(this).addClass("active");

      page.show();

      var totop = setInterval(function () {
        $(".pages").animate({scrollTop: 0}, 0);
      }, 10);

      setTimeout(function () {
        page.addClass("active");
        setTimeout(function () {
          clearInterval(totop);
        }, 1000);
      }, 100);

      window.dispatchEvent(new Event('resize'));

    }


    $(".menu li").click(function () {

      toggle_page($(this).data("target"));

      // Menu
      if (!$(this).data("target")) return;
      if ($(this).is(".active")) return;
      $(".menu li").not($(this)).removeClass("active");
      $(this).addClass("active");

    });
  
    


    window.page = window.location.hash;
    if (window.page != "") {
      $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
    }

    /* init material bootstrap js */
    $.material.init();
});
</script>




<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
